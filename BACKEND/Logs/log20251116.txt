2025-11-16 15:04:54.075 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:04:54.128 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:04:54.158 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:04:54.160 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:04:54.366 +01:00 [ERR] Hosting failed to start
CsvHelper.TypeConversion.TypeConverterException: The conversion cannot be performed.
    Text: '3.0'
    MemberName: RequiredMinYears
    MemberType: System.Nullable`1[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
    TypeConverter: 'CsvHelper.TypeConversion.NullableConverter'
IReader state:
   ColumnCount: 14
   CurrentIndex: 12
   HeaderRecord:
["job_id","title","company","location","date_posted","job_url","description","job_function","match_context","hard_skills","domain_keywords","job_title","required_min_years","embedding"]
IParser state:
   ByteCount: 0
   CharCount: 15491
   Row: 2
   RawRow: 38
   Count: 14
   RawRecord:
4312052657,Data Engineer,Coca-Cola HBC,"New Cairo, Cairo, Egypt",2025-10-08,https://eg.linkedin.com/jobs/view/data-engineer-at-coca-cola-hbc-4312052657,"We are looking for a highly skilled Data Engineer with significant technical skills in Azure and business acumen to join our team in Coca-Cola Hellenic Digital & Technology Platform Services (DTPS) and be part of the Analytics Products Engineering team. You will have the opportunity to contribute to the strategy, design and development of our Analytics use cases, providing insights and supporting decision making for end users. The role involves significant collaboration with business and IT teams, and an opportunity to integrate & transform data from various systems into structures that are suitable for building analytical solutions, by developing efficient Azure-based data pipelines.
YOUR NEW KEY RESPONSIBILITIES:
Collaborate with CCH architects across different IT (DTPS) teams and with cross-functional teams to gather requirements, define technical specifications, and provide architectural guidance for Azure projects. Contribute and align on the strategy, design and implementation of the end2end data journey to expose analytics insights for consumption by different reporting layers;
Ability to load data from Azure Data Sources (Azure SQL Databricks Warehouse/Synapse), visualize data, setup data refresh, analyze and write queries in SQL;
Develop and implement data governance and data quality frameworks to ensure the integrity and accuracy of data;
Design, develop, implement and optimize data pipelines for scalability, performance, security and cost efficiency. Optimize data storage, retrieval, and processing techniques to achieve high performance and cost efficiency;
Implement security and access control measures to protect sensitive data within Azure environments;
Perform data profiling, analysis, and validation to identify and address data quality issues.
Develop and maintain documentation for data solutions, including data models, data flows, and technical specifications;
Stay up to date with the latest Azure data services, tools, and best practices, and provide recommendations for their adoption;
Lead and guide Azure developers and data engineers from vendors, providing guidance and support in Azure data engineering techniques and methodologies and ensuring development as per CCH standards and guidelines;
Ability to understand business requirements and convert into clearly documented technical requirements (dimensions, KBIs, data structure, data granularity, target users), following the agreed guidelines, standards and rules;
Collaborate with DevOps teams to implement continuous integration and delivery pipelines for Azure-based applications;
Collaborate with and support PowerBI developers to test different approaches for data connections and data transfers to Power BI, to identify the optimal approach per use case considering data volume, Power BI performance, as well as data quality and security considerations.
ARE THESE YOUR SECRET INGREDIENTS?
Deep hands-on experience with MS Azure Data Factory, MS Azure Data Lake Storage, SQL Database (T-SQL), Azure Databricks, Proficiency in SQL and data manipulation languages for data extraction, transformation, and loading.
3+ years of experience in data engineering, data science or related field, with a focus on Azure data platforms
Deep hands-on experience in Python; pyspark
Experience with data visualization tools and techniques for creating meaningful data insights (e.g., Power BI, PowerApps) is appreciated;
Experience with Data Science techniques, such as feature engineering and modeling is appreciated;
Experience in performance optimization techniques in Azure technologies for PowerBI reporting consumption is a plus;
Experience with big data architectures and large data volumes technologies (partitioned tables with billions of records, files with hundreds of GBs). Familiarity with big data technologies such as Hadoop, Spark, and Hive;
Strong hands-on understanding of DevSecOps concepts and tools. Expertise in practical implementation of DevSecOps, in particular Azure DevOps toolkit and automated testing capabilities;
Strong understanding of DevOps principles and experience with CI/CD pipelines, version control systems (e.g. Git), and automated deployment tools;
Design and implement data pipelines and ETL processes, ensuring data quality and availability for machine learning models, while possessing a foundational understanding of machine learning concepts and techniques.
Develop and maintain scalable machine learning pipelines and infrastructure, ensuring seamless integration and deployment of models in production environments (MLOps).
Bachelor's degree in Computer Science, Engineering, or a related field (or equivalent practical experience);
Knowledge of SAP BW (extractors, transformations, queries, data export) would be appreciated.
Understanding of Agile methodology and SAFe Agile is appreciated;
Strong communication and interpersonal skills, with the ability to collaborate effectively with cross-functional teams, stakeholders and vendors;
Azure certification, such as Azure Data Engineer Associate, is a plus.
ABOUT YOUR NEW TEAM
We are a family of 33 thousand engaged people. Each and every one of us is the secret ingredient of Coca-Cola HBC - one of the world’s largest bottlers and partner of The Coca-Cola Company. Our every day mission is to delight over 715 million consumers by offering a choice of over 100 iconic global and favorite local brands in the moments that matter, 24 hours a day, 7 days a week. We are a truly empowered and talented team that drives superior results by winning and learning every day in 29 countries, across 3 continents. Our success comes from us working together as one to make a positive difference for the local communities we serve.
AT COCA-COLA HBC, DIVERSITY HELPS US THRIVE
Including and celebrating different people and opinions is embedded in our growth story. We are committed to fostering diverse teams that reflect the communities we serve, and to creating an inclusive environment where everyone’s unique perspectives are valued and heard. By constantly building a diverse and inclusive workplace, we enrich our decision-making and provide ever more innovative solutions and shared value
Show more
Show less",Information Technology,"This role involves leading the design and development of data pipelines and analytics solutions on Azure, enabling business insights and decision-making through scalable and secure data platforms. It requires collaborating with cross-functional teams to define requirements, implement data governance, and optimize performance and costs in cloud environments.","['Azure Data Factory', 'Azure Data Lake Storage', 'SQL']","['data pipelines', 'data governance', 'data quality', 'Azure', 'Power BI']",Data Engineer,3.0,"[0.017399447038769722, 0.01201433502137661, -0.05226965621113777, 0.02020183578133583, -0.008915062062442303, -0.02652774564921856, -0.014235024340450764, -0.050765831023454666, 0.058618493378162384, 0.05271098390221596, -0.07137957960367203, -0.035096533596515656, 0.05762539431452751, 0.06062876060605049, -0.002114495262503624, 0.11242444068193436, -0.007858607918024063, -0.028410986065864563, -0.12685292959213257, -0.06083618476986885, -0.038471873849630356, -0.009414209052920341, -0.0674431324005127, -0.020734034478664398, -0.029333658516407013, 0.014119294472038746, -0.07325772941112518, -0.01950816996395588, -0.029922520741820335, -0.03435496613383293, -0.02965526469051838, -0.05954185873270035, 0.0076600853353738785, 0.10287252068519592, -0.057972658425569534, 0.04615851491689682, 0.05800628662109375, -0.005166474264115095, -0.03793269395828247, -0.023650290444493294, 0.003811950795352459, -0.05861157551407814, -0.11061670631170273, -0.03489740192890167, -0.023958871141076088, 0.0031383782625198364, -0.02090422809123993, -0.04354027658700943, -0.05763792619109154, 0.10047762840986252, -0.0940554216504097, -0.09540588408708572, -0.018429383635520935, 0.05597962811589241, -0.021307749673724174, 0.07200916856527328, 0.0422993041574955, -0.03997904807329178, 0.01741803251206875, -0.009126952849328518, 0.027268672361969948, -0.10543341934680939, -0.0010447908425703645, 0.05200842395424843, 0.02976232022047043, 0.028536129742860794, -0.010892337188124657, 0.0022426811046898365, -0.01962871290743351, -0.03952265530824661, 0.006572837941348553, -0.04798495024442673, -0.08526060730218887, -0.052067700773477554, -0.017252059653401375, 0.040004149079322815, 0.022480063140392303, 0.041441526263952255, 0.09524109959602356, -0.019079802557826042, 0.028526531532406807, 0.0881766527891159, -0.0014044928830116987, 0.1379466950893402, 0.011134871281683445, -0.04923664778470993, -0.020149320363998413, -0.012161102145910263, -0.010558145120739937, 0.0012254412285983562, -0.024563031271100044, -0.032667238265275955, 0.11013466119766235, 0.009743567556142807, -0.005101843271404505, -0.03362021595239639, -0.05464097857475281, -0.047052040696144104, 0.061096638441085815, -0.012434751726686954, -0.04748326539993286, 0.022397426888346672, 0.021935245022177696, 0.008150609210133553, -0.031109094619750977, -0.05151970684528351, 0.024838445708155632, 0.02292926423251629, -0.03620637208223343, 0.027138778939843178, 0.03306678682565689, -0.025662878528237343, 0.020259184762835503, -0.04466323181986809, 0.05473388358950615, -0.007198130711913109, -0.0796533152461052, 0.05147778242826462, -0.03307988494634628, 0.03207080811262131, -0.0049925195053219795, 0.015739861875772476, 0.01785900816321373, -0.06244746223092079, 0.06570135056972504, 0.0426030270755291, -0.07917043566703796, -1.4925229731871507e-33, 0.01471122819930315, 0.012533365748822689, 0.030372517183423042, -0.011897511780261993, 0.08314795047044754, -0.03158728405833244, 0.04665125906467438, -0.041299737989902496, -0.1628960222005844, 0.0063743372447788715, -0.024411993101239204, 0.05567353218793869, 0.02912062779068947, 0.023137971758842468, 0.026521405205130577, -0.01659868285059929, 0.011431197635829449, 0.0500066764652729, 0.01989930495619774, 0.021976985037326813, 0.0515969954431057, -0.08886171132326126, 0.03040466643869877, 0.04002079367637634, 0.09761853516101837, -0.027966711670160294, 0.08385507762432098, 0.013431411236524582, 0.04393843561410904, 0.015492935664951801, -0.04934214800596237, 0.0032708675134927034, 0.01534024067223072, 0.0258056428283453, 0.030651837587356567, -0.007246117107570171, -0.005480774212628603, -0.010200291872024536, 0.05004259943962097, 0.13614675402641296, 0.05486825108528137, 0.013741586357355118, -0.021837320178747177, 0.009341259486973286, -0.05505876615643501, 0.031214801594614983, -0.0057897972874343395, 0.02304219827055931, 0.058766596019268036, -0.009841903112828732, 0.0016450202092528343, -0.005914255045354366, 0.07809927314519882, 0.043812572956085205, 0.06944376230239868, -0.03556380420923233, 0.023053577169775963, -0.10081716626882553, 0.0010979307116940618, 0.04772472009062767, -0.08182770013809204, -0.04559066891670227, -0.039545655250549316, 0.03819701820611954, -0.035573434084653854, -0.04064789414405823, 0.056409306824207306, 0.04202701523900032, 0.08415261656045914, -0.03686191141605377, -0.014224986545741558, -0.04003253951668739, 0.07751187682151794, 0.0019791426602751017, 0.016651179641485214, -0.07485722750425339, -0.044447243213653564, -0.012990206480026245, 0.041319604963064194, -0.011441127397119999, -0.09174857288599014, 0.002551701618358493, 0.05763451009988785, 0.03464319184422493, -0.09388608485460281, -0.043788619339466095, -0.009972617961466312, 0.009268873371183872, -0.07715808600187302, 0.04373902454972267, -0.09801024198532104, -0.004502103663980961, 0.024679969996213913, 0.019987203180789948, -0.009617111645638943, -1.8239610899944315e-34, -0.022309690713882446, -0.04172389209270477, -0.03063325211405754, 0.060272879898548126, 0.04824230447411537, -0.011960999108850956, 0.002322224900126457, -0.12685881555080414, 0.07085227966308594, 0.029312942177057266, -0.021009432151913643, 0.005198175553232431, 0.030987689271569252, 0.030803201720118523, -0.02841765619814396, 0.010619193315505981, 0.013122163712978363, -0.10197177529335022, 0.04536088556051254, -0.04274770990014076, -0.03995294123888016, -0.029028858989477158, 0.009781597182154655, 0.049886882305145264, 0.023832492530345917, 0.0321173295378685, -0.04619608819484711, -0.11590997129678726, 0.0848688930273056, 0.003824994433671236, -0.07032238692045212, -0.034553635865449905, 0.021435042843222618, -0.0946701169013977, -0.08874377608299255, -0.003666143398731947, 0.03791375830769539, -0.021051974967122078, 0.010797814466059208, -0.02986583299934864, -0.0233637485653162, -0.046273525804281235, -0.01664445735514164, -0.057430777698755264, -0.02868657186627388, 0.06378617137670517, 0.02929793670773506, 0.05301586911082268, -0.03640403226017952, -0.06584152579307556, -0.02889535017311573, 0.08622301369905472, 0.009819033555686474, 0.04609530791640282, -0.04969385638833046, -0.034867748618125916, 0.06086987629532814, 0.02630193717777729, -0.06622608006000519, 0.06378590315580368, 0.042743779718875885, 0.07148173451423645, 0.06374260038137436, 0.03159279003739357, 0.053744737058877945, 0.03655221313238144, 0.003699706867337227, -0.08284977823495865, -0.041317231953144073, -0.03768531233072281, -0.057726092636585236, -0.11244889348745346, -0.04650743305683136, 0.017211178317666054, 0.00956708937883377, -0.03922399505972862, -0.055449649691581726, -0.11165383458137512, -0.005040475632995367, 0.10075732320547104, 0.02236347645521164, 0.03554555028676987, 0.011939406394958496, 0.04673473909497261, 0.02501356601715088, -0.006594789680093527, 0.08996239304542542, -0.033530592918395996, -0.028139673173427582, 0.012099585495889187, -0.10983535647392273, -0.07582151144742966, -0.1375410258769989, 0.027388842776417732, 0.01151398103684187, -3.54703608707041e-08, 0.02006988599896431, 0.05561469495296478, -0.01916505955159664, -0.024757053703069687, -0.011643575504422188, -0.01379365473985672, 0.03552449494600296, 0.12983112037181854, 0.05831942334771156, 0.0747741237282753, 0.0562482550740242, -0.04571619629859924, 0.011042319238185883, 0.03063388727605343, 0.09357329457998276, 0.0063462709076702595, 0.04173467680811882, 0.010252965614199638, -0.008054492995142937, -0.034091610461473465, -0.006477307062596083, 0.042511701583862305, -0.08181287348270416, -0.0428650863468647, -0.009646261110901833, -0.005596781149506569, 0.00788751058280468, 0.04298759996891022, -0.02233344130218029, -0.016217980533838272, -0.04533347859978676, -0.018865833058953285, 0.03198756277561188, -0.0012517337454482913, 0.049992725253105164, -0.03139185532927513, 0.012927663512527943, 0.022335298359394073, 0.04683128371834755, 0.01343765389174223, -0.02135554887354374, 0.1211598813533783, -0.010969897732138634, 0.04590308666229248, -0.06508050858974457, -0.030299391597509384, -0.034820083528757095, 0.04512482136487961, -0.008205890655517578, 0.08166894316673279, 0.029216766357421875, -0.024580227211117744, 0.022360991686582565, 0.1446429193019867, 0.06862111389636993, 0.02972514182329178, 0.002375439740717411, -0.09580850601196289, 0.07744657248258591, 0.10725903511047363, 0.05396043509244919, -0.03830493241548538, 0.047134481370449066, -0.10400207340717316]"


   at CsvHelper.TypeConversion.DefaultTypeConverter.ConvertFromString(String text, IReaderRow row, MemberMapData memberMapData)
   at CsvHelper.TypeConversion.Int32Converter.ConvertFromString(String text, IReaderRow row, MemberMapData memberMapData)
   at CsvHelper.TypeConversion.NullableConverter.ConvertFromString(String text, IReaderRow row, MemberMapData memberMapData)
   at lambda_method55(Closure)
   at CsvHelper.CsvReader.GetRecords[T]()+MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 54
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 29
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-11-16 15:04:54.436 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 15:06:50.576 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:06:50.647 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:06:50.670 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:06:50.673 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:06:50.756 +01:00 [INF] Nombre de jobs lus : 10
2025-11-16 15:06:59.555 +01:00 [INF] Insertion terminée pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:06:59.558 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:13:38.201 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:13:38.254 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:13:38.269 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:13:38.271 +01:00 [INF] Aucun fichier CSV trouvé dans le dossier.
2025-11-16 15:15:39.499 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:15:39.566 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:15:39.587 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:15:39.590 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:15:39.684 +01:00 [INF] Nombre de jobs lus : 10
2025-11-16 15:15:50.497 +01:00 [ERR] BackgroundService failed
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte PRIMARY KEY « PK__Jobs__056690C225309921 ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 65
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 29
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:61d525ee-696d-4ed1-9a84-c5305b204d8f
Error Number:2627,State:1,Class:14
2025-11-16 15:15:50.528 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte PRIMARY KEY « PK__Jobs__056690C225309921 ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 65
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 29
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:61d525ee-696d-4ed1-9a84-c5305b204d8f
Error Number:2627,State:1,Class:14
2025-11-16 15:15:50.553 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 15:24:45.056 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:24:45.123 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:24:45.149 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:24:45.152 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:24:45.252 +01:00 [INF] Nombre de jobs lus : 10
2025-11-16 15:24:45.271 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:27:36.123 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:27:36.179 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:27:36.197 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:27:36.200 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:27:36.281 +01:00 [INF] Nombre de jobs lus : 10
2025-11-16 15:27:36.293 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:28:02.947 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:28:02.992 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:28:03.017 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:28:03.020 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:28:03.076 +01:00 [INF] Nombre de jobs lus : 10
2025-11-16 15:28:03.085 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:28:03.194 +01:00 [INF] Toutes les lignes insérées pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:28:03.196 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:34:04.456 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:34:04.500 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:34:04.522 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:34:04.524 +01:00 [INF] Aucun fichier CSV trouvé dans le dossier.
2025-11-16 15:34:30.375 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:34:30.418 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:34:30.446 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:34:30.449 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:34:30.546 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:34:30.557 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:34:30.699 +01:00 [ERR] Erreur lors de l'insertion dans la table Jobs pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte PRIMARY KEY « PK__Jobs__056690C225309921 ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 119
ClientConnectionId:78907cca-2dd4-4b84-b931-5aac92b44fcc
Error Number:2627,State:1,Class:14
2025-11-16 15:36:24.127 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:36:24.168 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:36:24.187 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:36:24.189 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:36:24.247 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:36:24.260 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:36:24.388 +01:00 [INF] Toutes les lignes insérées pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:36:24.393 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:42:10.716 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:42:10.776 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:42:10.807 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:42:10.809 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:42:10.897 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:42:10.906 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:42:11.029 +01:00 [INF] Toutes les lignes insérées pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:42:11.031 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:46:45.353 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:46:45.415 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:46:45.448 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:46:45.450 +01:00 [INF] Aucun fichier CSV trouvé dans le dossier.
2025-11-16 15:48:04.574 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:48:04.654 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:48:04.693 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:48:04.696 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:48:04.838 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:48:04.854 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:52:23.221 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:52:23.288 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:52:23.327 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:52:23.330 +01:00 [INF] Aucun fichier CSV trouvé dans le dossier.
2025-11-16 15:53:07.602 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:53:07.727 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:53:07.791 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:53:07.794 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:53:07.943 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:53:07.966 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:55:38.030 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:55:38.091 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:55:38.117 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:55:38.120 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:55:38.218 +01:00 [INF] Total jobs lus : 10
2025-11-16 15:55:38.234 +01:00 [INF] Nombre de lignes dans DataTable : 10
2025-11-16 15:57:13.923 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 15:57:14.004 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 15:57:14.028 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 15:57:14.031 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:57:14.396 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:57:24.468 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 15:57:24.471 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:04:04.880 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:04:04.928 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:04:04.947 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:04:04.949 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:04:05.226 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:04:05.260 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:04:05.263 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:11:17.236 +01:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-16 16:11:26.729 +01:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-16 16:14:05.389 +01:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-16 16:18:42.389 +01:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-16 16:21:20.891 +01:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-16 16:22:46.515 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:22:46.619 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:22:46.659 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:24:44.613 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:24:44.655 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:24:44.668 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:25:43.473 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:25:43.534 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:25:43.555 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:25:43.558 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:25:43.926 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:25:43.966 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:25:43.968 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:31:27.237 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:31:27.279 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:31:27.297 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:31:27.299 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:31:27.508 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:31:27.537 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:31:27.539 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:32:21.764 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:32:21.807 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:32:21.823 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:32:21.825 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:32:22.064 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:32:22.084 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:32:22.089 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:34:57.614 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:34:57.667 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:34:57.691 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:34:57.693 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:34:57.958 +01:00 [INF] Insertion réussie de 10 lignes dans la table temporaire #TempJobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:34:57.981 +01:00 [INF] Opération MERGE (Upsert) réussie de #TempJobs vers Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:34:57.984 +01:00 [INF] Fichier supprimé : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:39:55.968 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:39:56.011 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:39:56.032 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:39:56.034 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:39:56.266 +01:00 [ERR] Erreur critique lors de l'opération de MERGE (Upsert) pour le fichier : enriched_20251103_184153_egypt_data_engineer.csv.
System.InvalidOperationException: The given value '4312052657' of type Int64 from the data source cannot be converted to type int for Column 0 [Id] Row 1.
 ---> System.OverflowException: Failed to convert parameter value from a Int64 to a Int32.
 ---> System.OverflowException: Value was either too large or too small for an Int32.
   at System.Convert.ThrowInt32OverflowException()
   at System.Convert.ToInt32(Int64 value)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.PerformMergeOperationAsync(DataTable dataTable, String fileName) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 137
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 103
2025-11-16 16:40:23.261 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:43:20.814 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:43:20.860 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:43:20.885 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:43:20.887 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:43:21.102 +01:00 [INF] Insertion réussie de 10 lignes dans Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:43:21.103 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:46:15.603 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:46:15.647 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:46:15.666 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:46:15.669 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:46:15.846 +01:00 [INF] Insertion réussie de 10 lignes dans Jobs pour enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:46:15.847 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:46:35.761 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:48:19.330 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:48:19.372 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:48:19.397 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:48:19.400 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:48:19.649 +01:00 [ERR] BackgroundService failed
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.PerformBulkInsertAsync(DataTable dataTable, String fileName) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 134
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 100
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:fda32052-4ee2-4715-a41b-48de2ac5f8bb
Error Number:2627,State:1,Class:14
2025-11-16 16:48:19.716 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.PerformBulkInsertAsync(DataTable dataTable, String fileName) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 134
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 100
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:fda32052-4ee2-4715-a41b-48de2ac5f8bb
Error Number:2627,State:1,Class:14
2025-11-16 16:48:19.756 +01:00 [ERR] Hosting failed to start
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-11-16 16:48:19.762 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:51:36.277 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:51:36.323 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:51:36.348 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 16:51:36.351 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:51:36.660 +01:00 [ERR] BackgroundService failed
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 129
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 88
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 42
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 16:51:36.705 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 129
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 88
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 42
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 16:51:36.781 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:54:14.201 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:54:14.260 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:54:14.283 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:54:14.496 +01:00 [INF] 10 lignes insérées dans Jobs.
2025-11-16 16:54:14.498 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:55:23.489 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:55:23.544 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:55:23.568 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:55:23.770 +01:00 [INF] 10 lignes insérées dans Jobs.
2025-11-16 16:55:23.773 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:55:40.346 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:55:40.386 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:55:40.393 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:55:40.577 +01:00 [ERR] BackgroundService failed
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 128
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 76
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 39
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:4b13e0ee-ad86-44a0-9fa8-29ca587b8649
Error Number:2627,State:1,Class:14
2025-11-16 16:55:40.636 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 128
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 76
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 39
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:4b13e0ee-ad86-44a0-9fa8-29ca587b8649
Error Number:2627,State:1,Class:14
2025-11-16 16:55:40.688 +01:00 [ERR] Hosting failed to start
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-11-16 16:55:40.694 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:56:03.488 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:56:03.546 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:56:03.556 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:56:03.720 +01:00 [INF] 10 lignes insérées dans Jobs.
2025-11-16 16:56:03.723 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:56:12.005 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:57:51.191 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:57:51.233 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:57:51.268 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 16:57:51.302 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:57:51.682 +01:00 [ERR] BackgroundService failed
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 128
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 76
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 39
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:710d6938-3461-402f-b977-9eb538480962
Error Number:2627,State:1,Class:14
2025-11-16 16:57:51.721 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
Microsoft.Data.SqlClient.SqlException (0x80131904): Violation de la contrainte UNIQUE KEY « UQ_JobId ». Impossible d'insérer une clé en double dans l'objet « dbo.Jobs ». Valeur de clé dupliquée : (4118157355).
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 128
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 76
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 39
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:710d6938-3461-402f-b977-9eb538480962
Error Number:2627,State:1,Class:14
2025-11-16 16:57:51.804 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 16:58:18.441 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 16:58:18.500 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 16:58:18.552 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 16:58:18.559 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 16:58:18.816 +01:00 [INF] 10 lignes insérées dans Jobs.
2025-11-16 16:58:18.819 +01:00 [INF] Fichier traité : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:00:20.786 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:00:20.857 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:00:20.906 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:00:21.173 +01:00 [ERR] BackgroundService failed
CsvHelper.ReaderException: No members are mapped for type 'Job'.
IReader state:
   ColumnCount: 14
   CurrentIndex: -1
   HeaderRecord:
["job_id","title","company","location","date_posted","job_url","description","job_function","match_context","hard_skills","domain_keywords","job_title","required_min_years","embedding"]
IParser state:
   ByteCount: 0
   CharCount: 15491
   Row: 2
   RawRow: 38
   Count: 14
   RawRecord:
4312052657,Data Engineer,Coca-Cola HBC,"New Cairo, Cairo, Egypt",2025-10-08,https://eg.linkedin.com/jobs/view/data-engineer-at-coca-cola-hbc-4312052657,"We are looking for a highly skilled Data Engineer with significant technical skills in Azure and business acumen to join our team in Coca-Cola Hellenic Digital & Technology Platform Services (DTPS) and be part of the Analytics Products Engineering team. You will have the opportunity to contribute to the strategy, design and development of our Analytics use cases, providing insights and supporting decision making for end users. The role involves significant collaboration with business and IT teams, and an opportunity to integrate & transform data from various systems into structures that are suitable for building analytical solutions, by developing efficient Azure-based data pipelines.
YOUR NEW KEY RESPONSIBILITIES:
Collaborate with CCH architects across different IT (DTPS) teams and with cross-functional teams to gather requirements, define technical specifications, and provide architectural guidance for Azure projects. Contribute and align on the strategy, design and implementation of the end2end data journey to expose analytics insights for consumption by different reporting layers;
Ability to load data from Azure Data Sources (Azure SQL Databricks Warehouse/Synapse), visualize data, setup data refresh, analyze and write queries in SQL;
Develop and implement data governance and data quality frameworks to ensure the integrity and accuracy of data;
Design, develop, implement and optimize data pipelines for scalability, performance, security and cost efficiency. Optimize data storage, retrieval, and processing techniques to achieve high performance and cost efficiency;
Implement security and access control measures to protect sensitive data within Azure environments;
Perform data profiling, analysis, and validation to identify and address data quality issues.
Develop and maintain documentation for data solutions, including data models, data flows, and technical specifications;
Stay up to date with the latest Azure data services, tools, and best practices, and provide recommendations for their adoption;
Lead and guide Azure developers and data engineers from vendors, providing guidance and support in Azure data engineering techniques and methodologies and ensuring development as per CCH standards and guidelines;
Ability to understand business requirements and convert into clearly documented technical requirements (dimensions, KBIs, data structure, data granularity, target users), following the agreed guidelines, standards and rules;
Collaborate with DevOps teams to implement continuous integration and delivery pipelines for Azure-based applications;
Collaborate with and support PowerBI developers to test different approaches for data connections and data transfers to Power BI, to identify the optimal approach per use case considering data volume, Power BI performance, as well as data quality and security considerations.
ARE THESE YOUR SECRET INGREDIENTS?
Deep hands-on experience with MS Azure Data Factory, MS Azure Data Lake Storage, SQL Database (T-SQL), Azure Databricks, Proficiency in SQL and data manipulation languages for data extraction, transformation, and loading.
3+ years of experience in data engineering, data science or related field, with a focus on Azure data platforms
Deep hands-on experience in Python; pyspark
Experience with data visualization tools and techniques for creating meaningful data insights (e.g., Power BI, PowerApps) is appreciated;
Experience with Data Science techniques, such as feature engineering and modeling is appreciated;
Experience in performance optimization techniques in Azure technologies for PowerBI reporting consumption is a plus;
Experience with big data architectures and large data volumes technologies (partitioned tables with billions of records, files with hundreds of GBs). Familiarity with big data technologies such as Hadoop, Spark, and Hive;
Strong hands-on understanding of DevSecOps concepts and tools. Expertise in practical implementation of DevSecOps, in particular Azure DevOps toolkit and automated testing capabilities;
Strong understanding of DevOps principles and experience with CI/CD pipelines, version control systems (e.g. Git), and automated deployment tools;
Design and implement data pipelines and ETL processes, ensuring data quality and availability for machine learning models, while possessing a foundational understanding of machine learning concepts and techniques.
Develop and maintain scalable machine learning pipelines and infrastructure, ensuring seamless integration and deployment of models in production environments (MLOps).
Bachelor's degree in Computer Science, Engineering, or a related field (or equivalent practical experience);
Knowledge of SAP BW (extractors, transformations, queries, data export) would be appreciated.
Understanding of Agile methodology and SAFe Agile is appreciated;
Strong communication and interpersonal skills, with the ability to collaborate effectively with cross-functional teams, stakeholders and vendors;
Azure certification, such as Azure Data Engineer Associate, is a plus.
ABOUT YOUR NEW TEAM
We are a family of 33 thousand engaged people. Each and every one of us is the secret ingredient of Coca-Cola HBC - one of the world’s largest bottlers and partner of The Coca-Cola Company. Our every day mission is to delight over 715 million consumers by offering a choice of over 100 iconic global and favorite local brands in the moments that matter, 24 hours a day, 7 days a week. We are a truly empowered and talented team that drives superior results by winning and learning every day in 29 countries, across 3 continents. Our success comes from us working together as one to make a positive difference for the local communities we serve.
AT COCA-COLA HBC, DIVERSITY HELPS US THRIVE
Including and celebrating different people and opinions is embedded in our growth story. We are committed to fostering diverse teams that reflect the communities we serve, and to creating an inclusive environment where everyone’s unique perspectives are valued and heard. By constantly building a diverse and inclusive workplace, we enrich our decision-making and provide ever more innovative solutions and shared value
Show more
Show less",Information Technology,"This role involves leading the design and development of data pipelines and analytics solutions on Azure, enabling business insights and decision-making through scalable and secure data platforms. It requires collaborating with cross-functional teams to define requirements, implement data governance, and optimize performance and costs in cloud environments.","['Azure Data Factory', 'Azure Data Lake Storage', 'SQL']","['data pipelines', 'data governance', 'data quality', 'Azure', 'Power BI']",Data Engineer,3.0,"[0.017399447038769722, 0.01201433502137661, -0.05226965621113777, 0.02020183578133583, -0.008915062062442303, -0.02652774564921856, -0.014235024340450764, -0.050765831023454666, 0.058618493378162384, 0.05271098390221596, -0.07137957960367203, -0.035096533596515656, 0.05762539431452751, 0.06062876060605049, -0.002114495262503624, 0.11242444068193436, -0.007858607918024063, -0.028410986065864563, -0.12685292959213257, -0.06083618476986885, -0.038471873849630356, -0.009414209052920341, -0.0674431324005127, -0.020734034478664398, -0.029333658516407013, 0.014119294472038746, -0.07325772941112518, -0.01950816996395588, -0.029922520741820335, -0.03435496613383293, -0.02965526469051838, -0.05954185873270035, 0.0076600853353738785, 0.10287252068519592, -0.057972658425569534, 0.04615851491689682, 0.05800628662109375, -0.005166474264115095, -0.03793269395828247, -0.023650290444493294, 0.003811950795352459, -0.05861157551407814, -0.11061670631170273, -0.03489740192890167, -0.023958871141076088, 0.0031383782625198364, -0.02090422809123993, -0.04354027658700943, -0.05763792619109154, 0.10047762840986252, -0.0940554216504097, -0.09540588408708572, -0.018429383635520935, 0.05597962811589241, -0.021307749673724174, 0.07200916856527328, 0.0422993041574955, -0.03997904807329178, 0.01741803251206875, -0.009126952849328518, 0.027268672361969948, -0.10543341934680939, -0.0010447908425703645, 0.05200842395424843, 0.02976232022047043, 0.028536129742860794, -0.010892337188124657, 0.0022426811046898365, -0.01962871290743351, -0.03952265530824661, 0.006572837941348553, -0.04798495024442673, -0.08526060730218887, -0.052067700773477554, -0.017252059653401375, 0.040004149079322815, 0.022480063140392303, 0.041441526263952255, 0.09524109959602356, -0.019079802557826042, 0.028526531532406807, 0.0881766527891159, -0.0014044928830116987, 0.1379466950893402, 0.011134871281683445, -0.04923664778470993, -0.020149320363998413, -0.012161102145910263, -0.010558145120739937, 0.0012254412285983562, -0.024563031271100044, -0.032667238265275955, 0.11013466119766235, 0.009743567556142807, -0.005101843271404505, -0.03362021595239639, -0.05464097857475281, -0.047052040696144104, 0.061096638441085815, -0.012434751726686954, -0.04748326539993286, 0.022397426888346672, 0.021935245022177696, 0.008150609210133553, -0.031109094619750977, -0.05151970684528351, 0.024838445708155632, 0.02292926423251629, -0.03620637208223343, 0.027138778939843178, 0.03306678682565689, -0.025662878528237343, 0.020259184762835503, -0.04466323181986809, 0.05473388358950615, -0.007198130711913109, -0.0796533152461052, 0.05147778242826462, -0.03307988494634628, 0.03207080811262131, -0.0049925195053219795, 0.015739861875772476, 0.01785900816321373, -0.06244746223092079, 0.06570135056972504, 0.0426030270755291, -0.07917043566703796, -1.4925229731871507e-33, 0.01471122819930315, 0.012533365748822689, 0.030372517183423042, -0.011897511780261993, 0.08314795047044754, -0.03158728405833244, 0.04665125906467438, -0.041299737989902496, -0.1628960222005844, 0.0063743372447788715, -0.024411993101239204, 0.05567353218793869, 0.02912062779068947, 0.023137971758842468, 0.026521405205130577, -0.01659868285059929, 0.011431197635829449, 0.0500066764652729, 0.01989930495619774, 0.021976985037326813, 0.0515969954431057, -0.08886171132326126, 0.03040466643869877, 0.04002079367637634, 0.09761853516101837, -0.027966711670160294, 0.08385507762432098, 0.013431411236524582, 0.04393843561410904, 0.015492935664951801, -0.04934214800596237, 0.0032708675134927034, 0.01534024067223072, 0.0258056428283453, 0.030651837587356567, -0.007246117107570171, -0.005480774212628603, -0.010200291872024536, 0.05004259943962097, 0.13614675402641296, 0.05486825108528137, 0.013741586357355118, -0.021837320178747177, 0.009341259486973286, -0.05505876615643501, 0.031214801594614983, -0.0057897972874343395, 0.02304219827055931, 0.058766596019268036, -0.009841903112828732, 0.0016450202092528343, -0.005914255045354366, 0.07809927314519882, 0.043812572956085205, 0.06944376230239868, -0.03556380420923233, 0.023053577169775963, -0.10081716626882553, 0.0010979307116940618, 0.04772472009062767, -0.08182770013809204, -0.04559066891670227, -0.039545655250549316, 0.03819701820611954, -0.035573434084653854, -0.04064789414405823, 0.056409306824207306, 0.04202701523900032, 0.08415261656045914, -0.03686191141605377, -0.014224986545741558, -0.04003253951668739, 0.07751187682151794, 0.0019791426602751017, 0.016651179641485214, -0.07485722750425339, -0.044447243213653564, -0.012990206480026245, 0.041319604963064194, -0.011441127397119999, -0.09174857288599014, 0.002551701618358493, 0.05763451009988785, 0.03464319184422493, -0.09388608485460281, -0.043788619339466095, -0.009972617961466312, 0.009268873371183872, -0.07715808600187302, 0.04373902454972267, -0.09801024198532104, -0.004502103663980961, 0.024679969996213913, 0.019987203180789948, -0.009617111645638943, -1.8239610899944315e-34, -0.022309690713882446, -0.04172389209270477, -0.03063325211405754, 0.060272879898548126, 0.04824230447411537, -0.011960999108850956, 0.002322224900126457, -0.12685881555080414, 0.07085227966308594, 0.029312942177057266, -0.021009432151913643, 0.005198175553232431, 0.030987689271569252, 0.030803201720118523, -0.02841765619814396, 0.010619193315505981, 0.013122163712978363, -0.10197177529335022, 0.04536088556051254, -0.04274770990014076, -0.03995294123888016, -0.029028858989477158, 0.009781597182154655, 0.049886882305145264, 0.023832492530345917, 0.0321173295378685, -0.04619608819484711, -0.11590997129678726, 0.0848688930273056, 0.003824994433671236, -0.07032238692045212, -0.034553635865449905, 0.021435042843222618, -0.0946701169013977, -0.08874377608299255, -0.003666143398731947, 0.03791375830769539, -0.021051974967122078, 0.010797814466059208, -0.02986583299934864, -0.0233637485653162, -0.046273525804281235, -0.01664445735514164, -0.057430777698755264, -0.02868657186627388, 0.06378617137670517, 0.02929793670773506, 0.05301586911082268, -0.03640403226017952, -0.06584152579307556, -0.02889535017311573, 0.08622301369905472, 0.009819033555686474, 0.04609530791640282, -0.04969385638833046, -0.034867748618125916, 0.06086987629532814, 0.02630193717777729, -0.06622608006000519, 0.06378590315580368, 0.042743779718875885, 0.07148173451423645, 0.06374260038137436, 0.03159279003739357, 0.053744737058877945, 0.03655221313238144, 0.003699706867337227, -0.08284977823495865, -0.041317231953144073, -0.03768531233072281, -0.057726092636585236, -0.11244889348745346, -0.04650743305683136, 0.017211178317666054, 0.00956708937883377, -0.03922399505972862, -0.055449649691581726, -0.11165383458137512, -0.005040475632995367, 0.10075732320547104, 0.02236347645521164, 0.03554555028676987, 0.011939406394958496, 0.04673473909497261, 0.02501356601715088, -0.006594789680093527, 0.08996239304542542, -0.033530592918395996, -0.028139673173427582, 0.012099585495889187, -0.10983535647392273, -0.07582151144742966, -0.1375410258769989, 0.027388842776417732, 0.01151398103684187, -3.54703608707041e-08, 0.02006988599896431, 0.05561469495296478, -0.01916505955159664, -0.024757053703069687, -0.011643575504422188, -0.01379365473985672, 0.03552449494600296, 0.12983112037181854, 0.05831942334771156, 0.0747741237282753, 0.0562482550740242, -0.04571619629859924, 0.011042319238185883, 0.03063388727605343, 0.09357329457998276, 0.0063462709076702595, 0.04173467680811882, 0.010252965614199638, -0.008054492995142937, -0.034091610461473465, -0.006477307062596083, 0.042511701583862305, -0.08181287348270416, -0.0428650863468647, -0.009646261110901833, -0.005596781149506569, 0.00788751058280468, 0.04298759996891022, -0.02233344130218029, -0.016217980533838272, -0.04533347859978676, -0.018865833058953285, 0.03198756277561188, -0.0012517337454482913, 0.049992725253105164, -0.03139185532927513, 0.012927663512527943, 0.022335298359394073, 0.04683128371834755, 0.01343765389174223, -0.02135554887354374, 0.1211598813533783, -0.010969897732138634, 0.04590308666229248, -0.06508050858974457, -0.030299391597509384, -0.034820083528757095, 0.04512482136487961, -0.008205890655517578, 0.08166894316673279, 0.029216766357421875, -0.024580227211117744, 0.022360991686582565, 0.1446429193019867, 0.06862111389636993, 0.02972514182329178, 0.002375439740717411, -0.09580850601196289, 0.07744657248258591, 0.10725903511047363, 0.05396043509244919, -0.03830493241548538, 0.047134481370449066, -0.10400207340717316]"


   at CsvHelper.Expressions.ObjectRecordCreator.CreateCreateRecordDelegate(Type recordType)
   at CsvHelper.Expressions.RecordCreator.GetCreateRecordDelegate[T](Type recordType)
   at CsvHelper.Expressions.RecordManager.GetReadDelegate[T](Type recordType)
   at CsvHelper.CsvReader.GetRecords[T]()+MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 30
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:00:21.269 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
CsvHelper.ReaderException: No members are mapped for type 'Job'.
IReader state:
   ColumnCount: 14
   CurrentIndex: -1
   HeaderRecord:
["job_id","title","company","location","date_posted","job_url","description","job_function","match_context","hard_skills","domain_keywords","job_title","required_min_years","embedding"]
IParser state:
   ByteCount: 0
   CharCount: 15491
   Row: 2
   RawRow: 38
   Count: 14
   RawRecord:
4312052657,Data Engineer,Coca-Cola HBC,"New Cairo, Cairo, Egypt",2025-10-08,https://eg.linkedin.com/jobs/view/data-engineer-at-coca-cola-hbc-4312052657,"We are looking for a highly skilled Data Engineer with significant technical skills in Azure and business acumen to join our team in Coca-Cola Hellenic Digital & Technology Platform Services (DTPS) and be part of the Analytics Products Engineering team. You will have the opportunity to contribute to the strategy, design and development of our Analytics use cases, providing insights and supporting decision making for end users. The role involves significant collaboration with business and IT teams, and an opportunity to integrate & transform data from various systems into structures that are suitable for building analytical solutions, by developing efficient Azure-based data pipelines.
YOUR NEW KEY RESPONSIBILITIES:
Collaborate with CCH architects across different IT (DTPS) teams and with cross-functional teams to gather requirements, define technical specifications, and provide architectural guidance for Azure projects. Contribute and align on the strategy, design and implementation of the end2end data journey to expose analytics insights for consumption by different reporting layers;
Ability to load data from Azure Data Sources (Azure SQL Databricks Warehouse/Synapse), visualize data, setup data refresh, analyze and write queries in SQL;
Develop and implement data governance and data quality frameworks to ensure the integrity and accuracy of data;
Design, develop, implement and optimize data pipelines for scalability, performance, security and cost efficiency. Optimize data storage, retrieval, and processing techniques to achieve high performance and cost efficiency;
Implement security and access control measures to protect sensitive data within Azure environments;
Perform data profiling, analysis, and validation to identify and address data quality issues.
Develop and maintain documentation for data solutions, including data models, data flows, and technical specifications;
Stay up to date with the latest Azure data services, tools, and best practices, and provide recommendations for their adoption;
Lead and guide Azure developers and data engineers from vendors, providing guidance and support in Azure data engineering techniques and methodologies and ensuring development as per CCH standards and guidelines;
Ability to understand business requirements and convert into clearly documented technical requirements (dimensions, KBIs, data structure, data granularity, target users), following the agreed guidelines, standards and rules;
Collaborate with DevOps teams to implement continuous integration and delivery pipelines for Azure-based applications;
Collaborate with and support PowerBI developers to test different approaches for data connections and data transfers to Power BI, to identify the optimal approach per use case considering data volume, Power BI performance, as well as data quality and security considerations.
ARE THESE YOUR SECRET INGREDIENTS?
Deep hands-on experience with MS Azure Data Factory, MS Azure Data Lake Storage, SQL Database (T-SQL), Azure Databricks, Proficiency in SQL and data manipulation languages for data extraction, transformation, and loading.
3+ years of experience in data engineering, data science or related field, with a focus on Azure data platforms
Deep hands-on experience in Python; pyspark
Experience with data visualization tools and techniques for creating meaningful data insights (e.g., Power BI, PowerApps) is appreciated;
Experience with Data Science techniques, such as feature engineering and modeling is appreciated;
Experience in performance optimization techniques in Azure technologies for PowerBI reporting consumption is a plus;
Experience with big data architectures and large data volumes technologies (partitioned tables with billions of records, files with hundreds of GBs). Familiarity with big data technologies such as Hadoop, Spark, and Hive;
Strong hands-on understanding of DevSecOps concepts and tools. Expertise in practical implementation of DevSecOps, in particular Azure DevOps toolkit and automated testing capabilities;
Strong understanding of DevOps principles and experience with CI/CD pipelines, version control systems (e.g. Git), and automated deployment tools;
Design and implement data pipelines and ETL processes, ensuring data quality and availability for machine learning models, while possessing a foundational understanding of machine learning concepts and techniques.
Develop and maintain scalable machine learning pipelines and infrastructure, ensuring seamless integration and deployment of models in production environments (MLOps).
Bachelor's degree in Computer Science, Engineering, or a related field (or equivalent practical experience);
Knowledge of SAP BW (extractors, transformations, queries, data export) would be appreciated.
Understanding of Agile methodology and SAFe Agile is appreciated;
Strong communication and interpersonal skills, with the ability to collaborate effectively with cross-functional teams, stakeholders and vendors;
Azure certification, such as Azure Data Engineer Associate, is a plus.
ABOUT YOUR NEW TEAM
We are a family of 33 thousand engaged people. Each and every one of us is the secret ingredient of Coca-Cola HBC - one of the world’s largest bottlers and partner of The Coca-Cola Company. Our every day mission is to delight over 715 million consumers by offering a choice of over 100 iconic global and favorite local brands in the moments that matter, 24 hours a day, 7 days a week. We are a truly empowered and talented team that drives superior results by winning and learning every day in 29 countries, across 3 continents. Our success comes from us working together as one to make a positive difference for the local communities we serve.
AT COCA-COLA HBC, DIVERSITY HELPS US THRIVE
Including and celebrating different people and opinions is embedded in our growth story. We are committed to fostering diverse teams that reflect the communities we serve, and to creating an inclusive environment where everyone’s unique perspectives are valued and heard. By constantly building a diverse and inclusive workplace, we enrich our decision-making and provide ever more innovative solutions and shared value
Show more
Show less",Information Technology,"This role involves leading the design and development of data pipelines and analytics solutions on Azure, enabling business insights and decision-making through scalable and secure data platforms. It requires collaborating with cross-functional teams to define requirements, implement data governance, and optimize performance and costs in cloud environments.","['Azure Data Factory', 'Azure Data Lake Storage', 'SQL']","['data pipelines', 'data governance', 'data quality', 'Azure', 'Power BI']",Data Engineer,3.0,"[0.017399447038769722, 0.01201433502137661, -0.05226965621113777, 0.02020183578133583, -0.008915062062442303, -0.02652774564921856, -0.014235024340450764, -0.050765831023454666, 0.058618493378162384, 0.05271098390221596, -0.07137957960367203, -0.035096533596515656, 0.05762539431452751, 0.06062876060605049, -0.002114495262503624, 0.11242444068193436, -0.007858607918024063, -0.028410986065864563, -0.12685292959213257, -0.06083618476986885, -0.038471873849630356, -0.009414209052920341, -0.0674431324005127, -0.020734034478664398, -0.029333658516407013, 0.014119294472038746, -0.07325772941112518, -0.01950816996395588, -0.029922520741820335, -0.03435496613383293, -0.02965526469051838, -0.05954185873270035, 0.0076600853353738785, 0.10287252068519592, -0.057972658425569534, 0.04615851491689682, 0.05800628662109375, -0.005166474264115095, -0.03793269395828247, -0.023650290444493294, 0.003811950795352459, -0.05861157551407814, -0.11061670631170273, -0.03489740192890167, -0.023958871141076088, 0.0031383782625198364, -0.02090422809123993, -0.04354027658700943, -0.05763792619109154, 0.10047762840986252, -0.0940554216504097, -0.09540588408708572, -0.018429383635520935, 0.05597962811589241, -0.021307749673724174, 0.07200916856527328, 0.0422993041574955, -0.03997904807329178, 0.01741803251206875, -0.009126952849328518, 0.027268672361969948, -0.10543341934680939, -0.0010447908425703645, 0.05200842395424843, 0.02976232022047043, 0.028536129742860794, -0.010892337188124657, 0.0022426811046898365, -0.01962871290743351, -0.03952265530824661, 0.006572837941348553, -0.04798495024442673, -0.08526060730218887, -0.052067700773477554, -0.017252059653401375, 0.040004149079322815, 0.022480063140392303, 0.041441526263952255, 0.09524109959602356, -0.019079802557826042, 0.028526531532406807, 0.0881766527891159, -0.0014044928830116987, 0.1379466950893402, 0.011134871281683445, -0.04923664778470993, -0.020149320363998413, -0.012161102145910263, -0.010558145120739937, 0.0012254412285983562, -0.024563031271100044, -0.032667238265275955, 0.11013466119766235, 0.009743567556142807, -0.005101843271404505, -0.03362021595239639, -0.05464097857475281, -0.047052040696144104, 0.061096638441085815, -0.012434751726686954, -0.04748326539993286, 0.022397426888346672, 0.021935245022177696, 0.008150609210133553, -0.031109094619750977, -0.05151970684528351, 0.024838445708155632, 0.02292926423251629, -0.03620637208223343, 0.027138778939843178, 0.03306678682565689, -0.025662878528237343, 0.020259184762835503, -0.04466323181986809, 0.05473388358950615, -0.007198130711913109, -0.0796533152461052, 0.05147778242826462, -0.03307988494634628, 0.03207080811262131, -0.0049925195053219795, 0.015739861875772476, 0.01785900816321373, -0.06244746223092079, 0.06570135056972504, 0.0426030270755291, -0.07917043566703796, -1.4925229731871507e-33, 0.01471122819930315, 0.012533365748822689, 0.030372517183423042, -0.011897511780261993, 0.08314795047044754, -0.03158728405833244, 0.04665125906467438, -0.041299737989902496, -0.1628960222005844, 0.0063743372447788715, -0.024411993101239204, 0.05567353218793869, 0.02912062779068947, 0.023137971758842468, 0.026521405205130577, -0.01659868285059929, 0.011431197635829449, 0.0500066764652729, 0.01989930495619774, 0.021976985037326813, 0.0515969954431057, -0.08886171132326126, 0.03040466643869877, 0.04002079367637634, 0.09761853516101837, -0.027966711670160294, 0.08385507762432098, 0.013431411236524582, 0.04393843561410904, 0.015492935664951801, -0.04934214800596237, 0.0032708675134927034, 0.01534024067223072, 0.0258056428283453, 0.030651837587356567, -0.007246117107570171, -0.005480774212628603, -0.010200291872024536, 0.05004259943962097, 0.13614675402641296, 0.05486825108528137, 0.013741586357355118, -0.021837320178747177, 0.009341259486973286, -0.05505876615643501, 0.031214801594614983, -0.0057897972874343395, 0.02304219827055931, 0.058766596019268036, -0.009841903112828732, 0.0016450202092528343, -0.005914255045354366, 0.07809927314519882, 0.043812572956085205, 0.06944376230239868, -0.03556380420923233, 0.023053577169775963, -0.10081716626882553, 0.0010979307116940618, 0.04772472009062767, -0.08182770013809204, -0.04559066891670227, -0.039545655250549316, 0.03819701820611954, -0.035573434084653854, -0.04064789414405823, 0.056409306824207306, 0.04202701523900032, 0.08415261656045914, -0.03686191141605377, -0.014224986545741558, -0.04003253951668739, 0.07751187682151794, 0.0019791426602751017, 0.016651179641485214, -0.07485722750425339, -0.044447243213653564, -0.012990206480026245, 0.041319604963064194, -0.011441127397119999, -0.09174857288599014, 0.002551701618358493, 0.05763451009988785, 0.03464319184422493, -0.09388608485460281, -0.043788619339466095, -0.009972617961466312, 0.009268873371183872, -0.07715808600187302, 0.04373902454972267, -0.09801024198532104, -0.004502103663980961, 0.024679969996213913, 0.019987203180789948, -0.009617111645638943, -1.8239610899944315e-34, -0.022309690713882446, -0.04172389209270477, -0.03063325211405754, 0.060272879898548126, 0.04824230447411537, -0.011960999108850956, 0.002322224900126457, -0.12685881555080414, 0.07085227966308594, 0.029312942177057266, -0.021009432151913643, 0.005198175553232431, 0.030987689271569252, 0.030803201720118523, -0.02841765619814396, 0.010619193315505981, 0.013122163712978363, -0.10197177529335022, 0.04536088556051254, -0.04274770990014076, -0.03995294123888016, -0.029028858989477158, 0.009781597182154655, 0.049886882305145264, 0.023832492530345917, 0.0321173295378685, -0.04619608819484711, -0.11590997129678726, 0.0848688930273056, 0.003824994433671236, -0.07032238692045212, -0.034553635865449905, 0.021435042843222618, -0.0946701169013977, -0.08874377608299255, -0.003666143398731947, 0.03791375830769539, -0.021051974967122078, 0.010797814466059208, -0.02986583299934864, -0.0233637485653162, -0.046273525804281235, -0.01664445735514164, -0.057430777698755264, -0.02868657186627388, 0.06378617137670517, 0.02929793670773506, 0.05301586911082268, -0.03640403226017952, -0.06584152579307556, -0.02889535017311573, 0.08622301369905472, 0.009819033555686474, 0.04609530791640282, -0.04969385638833046, -0.034867748618125916, 0.06086987629532814, 0.02630193717777729, -0.06622608006000519, 0.06378590315580368, 0.042743779718875885, 0.07148173451423645, 0.06374260038137436, 0.03159279003739357, 0.053744737058877945, 0.03655221313238144, 0.003699706867337227, -0.08284977823495865, -0.041317231953144073, -0.03768531233072281, -0.057726092636585236, -0.11244889348745346, -0.04650743305683136, 0.017211178317666054, 0.00956708937883377, -0.03922399505972862, -0.055449649691581726, -0.11165383458137512, -0.005040475632995367, 0.10075732320547104, 0.02236347645521164, 0.03554555028676987, 0.011939406394958496, 0.04673473909497261, 0.02501356601715088, -0.006594789680093527, 0.08996239304542542, -0.033530592918395996, -0.028139673173427582, 0.012099585495889187, -0.10983535647392273, -0.07582151144742966, -0.1375410258769989, 0.027388842776417732, 0.01151398103684187, -3.54703608707041e-08, 0.02006988599896431, 0.05561469495296478, -0.01916505955159664, -0.024757053703069687, -0.011643575504422188, -0.01379365473985672, 0.03552449494600296, 0.12983112037181854, 0.05831942334771156, 0.0747741237282753, 0.0562482550740242, -0.04571619629859924, 0.011042319238185883, 0.03063388727605343, 0.09357329457998276, 0.0063462709076702595, 0.04173467680811882, 0.010252965614199638, -0.008054492995142937, -0.034091610461473465, -0.006477307062596083, 0.042511701583862305, -0.08181287348270416, -0.0428650863468647, -0.009646261110901833, -0.005596781149506569, 0.00788751058280468, 0.04298759996891022, -0.02233344130218029, -0.016217980533838272, -0.04533347859978676, -0.018865833058953285, 0.03198756277561188, -0.0012517337454482913, 0.049992725253105164, -0.03139185532927513, 0.012927663512527943, 0.022335298359394073, 0.04683128371834755, 0.01343765389174223, -0.02135554887354374, 0.1211598813533783, -0.010969897732138634, 0.04590308666229248, -0.06508050858974457, -0.030299391597509384, -0.034820083528757095, 0.04512482136487961, -0.008205890655517578, 0.08166894316673279, 0.029216766357421875, -0.024580227211117744, 0.022360991686582565, 0.1446429193019867, 0.06862111389636993, 0.02972514182329178, 0.002375439740717411, -0.09580850601196289, 0.07744657248258591, 0.10725903511047363, 0.05396043509244919, -0.03830493241548538, 0.047134481370449066, -0.10400207340717316]"


   at CsvHelper.Expressions.ObjectRecordCreator.CreateCreateRecordDelegate(Type recordType)
   at CsvHelper.Expressions.RecordCreator.GetCreateRecordDelegate[T](Type recordType)
   at CsvHelper.Expressions.RecordManager.GetReadDelegate[T](Type recordType)
   at CsvHelper.CsvReader.GetRecords[T]()+MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 30
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:00:21.422 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 17:25:51.216 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:25:51.286 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:25:51.323 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:25:51.629 +01:00 [ERR] BackgroundService failed
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - La chaîne de certificats a été fournie par une autorité qui n’est pas approuvée.)
 ---> System.ComponentModel.Win32Exception (0x80090325): La chaîne de certificats a été fournie par une autorité qui n’est pas approuvée.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.SNIWritePacket(PacketHandle packet, UInt32& sniError, Boolean canAccumulate, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.WriteSni(Boolean canAccumulate)
   at Microsoft.Data.SqlClient.TdsParserStateObject.WritePacket(Byte flushMode, Boolean canAccumulate)
   at Microsoft.Data.SqlClient.TdsParser.TdsLogin(SqlLogin rec, FeatureExtension requestedFeatures, SessionData recoverySessionData, FederatedAuthenticationFeatureExtensionData fedAuthFeatureExtensionData, SqlConnectionEncryptOption encrypt)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.Login(ServerInfo server, TimeoutTimer timeout, String newPassword, SecureString newSecurePassword, SqlConnectionEncryptOption encrypt)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 55
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:baffe903-0d24-4bd1-8e41-e01b1b131169
Error Number:-2146893019,State:0,Class:20
2025-11-16 17:25:51.723 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - La chaîne de certificats a été fournie par une autorité qui n’est pas approuvée.)
 ---> System.ComponentModel.Win32Exception (0x80090325): La chaîne de certificats a été fournie par une autorité qui n’est pas approuvée.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.SNIWritePacket(PacketHandle packet, UInt32& sniError, Boolean canAccumulate, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.WriteSni(Boolean canAccumulate)
   at Microsoft.Data.SqlClient.TdsParserStateObject.WritePacket(Byte flushMode, Boolean canAccumulate)
   at Microsoft.Data.SqlClient.TdsParser.TdsLogin(SqlLogin rec, FeatureExtension requestedFeatures, SessionData recoverySessionData, FederatedAuthenticationFeatureExtensionData fedAuthFeatureExtensionData, SqlConnectionEncryptOption encrypt)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.Login(ServerInfo server, TimeoutTimer timeout, String newPassword, SecureString newSecurePassword, SqlConnectionEncryptOption encrypt)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 55
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
ClientConnectionId:baffe903-0d24-4bd1-8e41-e01b1b131169
Error Number:-2146893019,State:0,Class:20
2025-11-16 17:25:51.821 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 17:26:59.230 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:26:59.273 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:26:59.310 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:26:59.697 +01:00 [ERR] BackgroundService failed
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:26:59.736 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:26:59.781 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 17:27:24.954 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:27:25.001 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:27:25.029 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:27:25.303 +01:00 [ERR] BackgroundService failed
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:27:25.358 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:27:25.399 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 17:28:16.852 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:28:16.893 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:28:16.926 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:28:17.315 +01:00 [ERR] BackgroundService failed
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:28:17.341 +01:00 [FTL] The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 99
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 47
   at SignatureAPP.Services.CsvJobService.ProcessCsvFilesAsync(Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 21
   at SignatureAPP.Services.CsvWatcherService.ProcessFileAndLogLinesAsync(String filePath) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 91
   at SignatureAPP.Services.CsvWatcherService.ProcessExistingFilesAsync() in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 72
   at SignatureAPP.Services.CsvWatcherService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvWatcherService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)
2025-11-16 17:28:17.376 +01:00 [INF] CsvWatcherService arrêté.
2025-11-16 17:32:18.818 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:32:18.899 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:32:18.966 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:32:18.969 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:32:19.125 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 10 ligne(s) de données.
2025-11-16 17:32:19.306 +01:00 [ERR] Erreur lors de l'insertion en base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 126
2025-11-16 17:33:24.897 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:33:24.938 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:33:24.970 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:33:24.972 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:33:25.123 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 10 ligne(s) de données.
2025-11-16 17:33:25.257 +01:00 [ERR] Erreur lors de l'insertion en base de données.
System.InvalidOperationException: The given value 'Coca-Cola HBC' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Coca-Cola HBC' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 125
2025-11-16 17:33:37.410 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:33:37.451 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:33:37.484 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:33:37.486 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:33:37.575 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 10 ligne(s) de données.
2025-11-16 17:33:37.649 +01:00 [ERR] Erreur lors de l'insertion en base de données.
System.InvalidOperationException: The given value 'Coca-Cola HBC' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Coca-Cola HBC' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 125
2025-11-16 17:34:52.143 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:34:52.190 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:34:52.229 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:34:52.233 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:34:52.345 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 10 ligne(s) de données.
2025-11-16 17:34:52.502 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Coca-Cola HBC' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Coca-Cola HBC' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 122
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 66
2025-11-16 17:36:52.381 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:36:52.432 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:36:52.476 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:36:52.478 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:36:52.591 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 10 ligne(s) de données.
2025-11-16 17:36:52.899 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
Microsoft.Data.SqlClient.SqlException (0x80131904): Impossible d'insérer la valeur NULL dans la colonne 'JobId', table 'CsChallenge.dbo.Jobs'. Cette colonne n'accepte pas les valeurs NULL. Échec de INSERT.
L'instruction a été arrêtée.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlBulkCopy.RunParser(BulkCopySimpleResultSet bulkCopyHandler)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinuedOnSuccess(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 128
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 58
ClientConnectionId:70ce268d-75aa-45de-ba4b-542088f81023
Error Number:515,State:2,Class:16
2025-11-16 17:39:19.188 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 17:39:19.234 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 17:39:19.267 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 17:39:19.270 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 17:39:19.385 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 17:39:19.552 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 20:21:05.838 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 20:21:05.897 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 20:21:05.953 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 20:21:05.956 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 20:21:06.107 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 20:21:06.363 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 20:21:20.561 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 20:21:47.655 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 20:22:30.021 +01:00 [INF] [AuthenController/Registre08] User fully registered
2025-11-16 20:22:37.343 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 20:22:37.401 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 20:22:37.425 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 20:22:52.949 +01:00 [INF] [TransactionService/AddDocument01] Document ajouté au retour avec ID : c4b684a8e22f465bbc18da39934ae390
2025-11-16 20:22:52.978 +01:00 [INF] [TransactionService/AddDocument02] Tous les documents ont été ajoutés avec succès.
2025-11-16 20:22:52.980 +01:00 [INF] [TransactionController/AddTransaction06] Documents  created successfully
2025-11-16 20:22:53.013 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:23:14.233 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:40:27.811 +01:00 [ERR] [AuthenController/CreateUser04] User  already  registered.
2025-11-16 20:40:31.386 +01:00 [ERR] [AuthenController/Login02] User not found in DB
2025-11-16 20:41:11.512 +01:00 [INF] [OTPService/generateOTP03] OTP generated and sent to email: hadhriramez0@gmail.com.
2025-11-16 20:41:11.515 +01:00 [INF] [OtpController/AddPassOTP03] Password OTP generated successfully .
2025-11-16 20:42:37.664 +01:00 [INF] [OTPService/generateOTP03] OTP generated and sent to email: hadhriramez0@gmail.com.
2025-11-16 20:42:37.666 +01:00 [INF] [OtpController/AddPassOTP03] Password OTP generated successfully .
2025-11-16 20:43:18.532 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 20:43:35.174 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 20:45:08.254 +01:00 [ERR] [AuthenController/CreateUser04] User  already  registered.
2025-11-16 20:45:13.975 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 20:45:17.874 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 20:45:17.917 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 20:45:17.926 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:45:24.802 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 20:45:35.534 +01:00 [INF] [UserController/updateuser04] User  updated successfully.
2025-11-16 20:45:40.806 +01:00 [INF] [UserController/updateuser04] User  updated successfully.
2025-11-16 20:45:55.518 +01:00 [INF] [UserController/PasswordChange06] Password changed successfully 
2025-11-16 20:46:00.700 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:46:06.344 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:47:13.311 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 20:47:19.418 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 20:47:19.465 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 20:47:19.477 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:47:48.687 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 20:47:49.839 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 20:55:19.379 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 20:55:19.459 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 20:55:19.527 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 20:55:19.532 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 20:55:19.722 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 20:55:20.011 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 20:56:59.289 +01:00 [ERR] [TransactionController/GetDocs] User not found in DB
2025-11-16 20:56:59.306 +01:00 [ERR] [UserController/GetUserByEmail02] User not found  email: hadhriramez0@gmail.com.
2025-11-16 21:00:24.249 +01:00 [ERR] [AuthenController/Login02] User not found in DB
2025-11-16 21:02:43.171 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:02:43.217 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:02:43.250 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:02:43.253 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:02:43.360 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:02:43.551 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 116
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 58
2025-11-16 21:03:03.318 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:03:03.363 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:03:03.393 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:03:03.396 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:03:03.496 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:03:03.659 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 116
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 58
2025-11-16 21:03:55.290 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:03:55.372 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:03:55.436 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:03:55.492 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 21:04:54.280 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 21:05:19.857 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:06:04.510 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:06:04.555 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:06:04.599 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:06:04.626 +01:00 [INF] Vérification/création de la table Jobs terminée.
2025-11-16 21:06:15.772 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:06:46.358 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:06:46.405 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:06:46.451 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:06:46.455 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:06:46.591 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:06:46.785 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 21:06:56.919 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 21:08:02.468 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:08:42.181 +01:00 [ERR] [AuthenController/Login03] Email not confirmed yet in DB
2025-11-16 21:08:48.542 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:11:04.830 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:11:04.935 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:11:04.991 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:11:05.000 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:11:05.163 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:11:05.425 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 21:11:12.784 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:12:15.729 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:12:15.785 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:12:15.825 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:12:15.836 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:12:15.996 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:12:16.245 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 21:12:40.716 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:12:50.101 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 21:12:53.816 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 21:12:53.840 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 21:14:11.967 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 21:14:12.017 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 21:14:12.059 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 21:14:12.062 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 21:14:12.196 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 21:14:12.389 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 21:15:46.713 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:17:47.282 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 21:17:54.628 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 21:18:08.095 +01:00 [INF] [AuthenController/Registre08] User fully registered
2025-11-16 21:18:12.742 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 21:18:16.448 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 21:18:16.576 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 21:18:16.601 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 21:18:27.151 +01:00 [INF] [TransactionService/AddDocument01] Document ajouté au retour avec ID : b5c375bdef294e07856df6da94760c7a
2025-11-16 21:18:27.191 +01:00 [INF] [TransactionService/AddDocument02] Tous les documents ont été ajoutés avec succès.
2025-11-16 21:18:27.194 +01:00 [INF] [TransactionController/AddTransaction06] Documents  created successfully
2025-11-16 21:18:27.227 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 21:18:34.030 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 21:18:34.047 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 21:55:13.885 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 21:55:18.822 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 21:55:20.412 +01:00 [ERR] [AuthenController/Login04]  login failer for user  
2025-11-16 21:55:29.008 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 21:55:29.032 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 21:55:29.046 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:05:59.546 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 22:07:16.454 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 22:07:16.523 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 22:07:16.571 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 22:07:16.575 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 22:07:16.746 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 22:07:16.957 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 22:07:35.629 +01:00 [ERR] [AuthenController/Login02] User not found in DB
2025-11-16 22:07:46.152 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 22:07:56.994 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 22:09:36.864 +01:00 [INF] [AuthenController/CreateUser05] Email confirmation resent to existing user
2025-11-16 22:16:19.421 +01:00 [INF] [AuthenController/Registre08] User fully registered
2025-11-16 22:16:50.114 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 22:16:50.281 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:16:50.313 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 22:19:22.878 +01:00 [ERR] [TransactionController/GetDocs] User not found in DB
2025-11-16 22:19:22.891 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 22:22:12.704 +01:00 [INF] [TransactionService/AddDocument01] Document ajouté au retour avec ID : 28bc1218a5ac437086ddce27f505c170
2025-11-16 22:22:12.737 +01:00 [INF] [TransactionService/AddDocument02] Tous les documents ont été ajoutés avec succès.
2025-11-16 22:22:12.738 +01:00 [INF] [TransactionController/AddTransaction06] Documents  created successfully
2025-11-16 22:22:12.771 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:26:35.349 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:26:35.353 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:36:27.144 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 22:36:27.205 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 22:36:27.255 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 22:36:27.258 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 22:36:27.391 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 22:36:27.714 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 22:37:39.615 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:37:39.783 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:39:35.745 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 22:39:35.792 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:39:35.816 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:40:24.400 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:40:24.416 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:40:24.428 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:40:24.459 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:41:07.399 +01:00 [INF] CsvWatcherService démarré.
2025-11-16 22:41:07.444 +01:00 [INF] Traitement initial des fichiers existants...
2025-11-16 22:41:07.480 +01:00 [INF] Fichier enriched_20251103_184153_egypt_data_engineer.csv contient 346 ligne(s) de données (hors en-tête).
2025-11-16 22:41:07.484 +01:00 [INF] Traitement du fichier : enriched_20251103_184153_egypt_data_engineer.csv
2025-11-16 22:41:07.605 +01:00 [INF] Nombre de lignes valides : 10
2025-11-16 22:41:07.792 +01:00 [ERR] Erreur lors de l'insertion d'un batch dans la base de données.
System.InvalidOperationException: The given value 'Data Engineer' of type String from the data source cannot be converted to type bigint for Column 1 [JobId] Row 1.
 ---> System.FormatException: Failed to convert parameter value from a String to a Int64.
 ---> System.FormatException: The input string 'Data Engineer' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt64(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlBulkCopy.ConvertValue(Object value, _SqlMetaData metadata, Boolean isNull, Boolean& isSqlType, Boolean& coercedToDataFeed)
   at Microsoft.Data.SqlClient.SqlBulkCopy.ReadWriteColumnValueAsync(Int32 col)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyColumnsAsync(Int32 col, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyRowsAsync(Int32 rowsSoFar, Int32 totalRows, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsyncContinued(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.CopyBatchesAsync(BulkCopySimpleResultSet internalResults, String updateBulkCommandText, CancellationToken cts, TaskCompletionSource`1 source)
   at Microsoft.Data.SqlClient.SqlBulkCopy.WriteToServerInternalRestContinuedAsync(BulkCopySimpleResultSet internalResults, CancellationToken cts, TaskCompletionSource`1 source)
--- End of stack trace from previous location ---
   at SignatureAPP.Services.CsvJobService.InsertBatchAsync(List`1 jobsBatch) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 123
   at SignatureAPP.Services.CsvJobService.ProcessCsvFileInBatchesAsync(String filePath, Int32 batchSize) in C:\Users\Ramez Hadhri\Desktop\CS_Challenge\Back\SignatureAPP\SignatureAPP\Services\CsvJobService.cs:line 59
2025-11-16 22:42:06.157 +01:00 [INF] [AuthenController/CreateUser03]   user created and  Verification email sent.
2025-11-16 22:42:09.569 +01:00 [ERR] [AuthenController/ConfirmEmail04] Email confirmation failed
2025-11-16 22:43:09.059 +01:00 [INF] [AuthenController/ConfirmEmail03] Email confirmed successfully 
2025-11-16 22:44:09.214 +01:00 [INF] [AuthenController/Registre08] User fully registered
2025-11-16 22:44:51.381 +01:00 [ERR] [UserController/GetUserByEmail02] User not found  email: ramezhadhri1@gmail.com.
2025-11-16 22:44:51.397 +01:00 [ERR] [TransactionController/GetDocs] User not found in DB
2025-11-16 22:44:57.204 +01:00 [INF] [AuthenController/Login05] Successful login 
2025-11-16 22:44:57.231 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:44:57.252 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 22:47:09.791 +01:00 [INF] [UserController/GetUserByEmail03]  retrieved user Successfully
2025-11-16 22:47:09.805 +01:00 [ERR] [TransactionController/GetDocs] Doc not found
2025-11-16 22:49:24.749 +01:00 [INF] [TransactionService/AddDocument01] Document ajouté au retour avec ID : d4069797926d4c51bd4953b473ccb5e4
2025-11-16 22:49:24.771 +01:00 [INF] [TransactionService/AddDocument02] Tous les documents ont été ajoutés avec succès.
2025-11-16 22:49:24.772 +01:00 [INF] [TransactionController/AddTransaction06] Documents  created successfully
2025-11-16 22:49:24.805 +01:00 [INF]  [TransactionService/GetPdfInfo01] retrieved pdfinfo    
2025-11-16 22:50:16.048 +01:00 [ERR] [UserController/GetUserByEmail02] User not found  email: ramezhadhri1@gmail.com.
2025-11-16 22:50:16.049 +01:00 [ERR] [TransactionController/GetDocs] User not found in DB
